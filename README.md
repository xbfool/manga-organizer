# æ¼«ç”»æ”¶è—æ ‡å‡†åŒ–æ•´ç†å·¥å…·

[![Python Version](https://img.shields.io/badge/python-3.12+-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

è‡ªåŠ¨åŒ–æ•´ç†ã€è½¬æ¢å’Œæ ‡å‡†åŒ–æ¼«ç”»æ–‡ä»¶çš„Pythonå·¥å…·ï¼Œæ”¯æŒæ—¥æ¼«ã€ç¾æ¼«ã€æ¸¯æ¼«å’Œè¿ç¯ç”»ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ” **æ™ºèƒ½æ‰«æå’Œåˆ†ç±»** - è‡ªåŠ¨è¯†åˆ«æ¼«ç”»ç±»å‹ï¼ˆæ—¥æ¼«ã€ç¾æ¼«ã€æ¸¯æ¼«ã€è¿ç¯ç”»ï¼‰
- ğŸ”„ **çœŸå®æ ¼å¼è½¬æ¢** - RAR/CBR â†’ CBZï¼ˆçœŸå®è§£å‹é‡å‹ç¼©ï¼Œéç®€å•é‡å‘½åï¼‰
- ğŸ“š **å…ƒæ•°æ®æå–** - æ™ºèƒ½è¯†åˆ«ç³»åˆ—åã€å·å·ã€ä½œè€…ã€è¯­è¨€ç‰ˆæœ¬
- ğŸ“ **æ ‡å‡†åŒ–ç›®å½•ç»“æ„** - æŒ‰ç…§è§„èŒƒçš„åˆ†ç±»è§„åˆ™é‡ç»„æ–‡ä»¶
- ğŸ·ï¸ **è§„èŒƒæ–‡ä»¶å‘½å** - ç»Ÿä¸€æ ¼å¼ï¼š`ä½œå“å - å·å·.cbz`
- ğŸŒ **å¤šæºå…ƒæ•°æ®æŸ¥è¯¢** - æ”¯æŒBangumiã€trace.moeã€AniListã€ComicVineç­‰API
- ğŸ“¦ **Komgaå‡†å¤‡å·¥å…·** - æœ¬åœ°è·å–å…ƒæ•°æ®ï¼Œç”ŸæˆComicInfo.xmlï¼Œæ•´ç†ä¸ºKomgaå°±ç»ªç›®å½•
- ğŸ·ï¸ **ComicInfo.xmlç”Ÿæˆ** - ç¬¦åˆAnansi Project v2.0æ ‡å‡†ï¼Œå®Œç¾å…¼å®¹Komga
- ğŸ–¼ï¸ **å°é¢ç®¡ç†** - è‡ªåŠ¨ä¸‹è½½ç³»åˆ—å°é¢ï¼Œæå–CBZå†…å°é¢
- ğŸ’¾ **éç ´åæ€§æ•´ç†** - ä¿ç•™åŸæ–‡ä»¶ï¼Œåˆ›å»ºæ–°ç›®å½•
- ğŸ“Š **è¯¦ç»†æŠ¥å‘Š** - ç”ŸæˆJSONæ ¼å¼çš„åˆ†æå’Œå¤„ç†æŠ¥å‘Š
- ğŸ”’ **å®‰å…¨å¯é ** - é¢„æ¼”æ¨¡å¼ã€è¯¦ç»†æ—¥å¿—ã€å¯éšæ—¶ä¸­æ–­

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [å®‰è£…](#å®‰è£…)
- [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
- [Komgaå‡†å¤‡å·¥å…·](#komgaå‡†å¤‡å·¥å…·)
- [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
- [å‘½åè§„èŒƒ](#å‘½åè§„èŒƒ)
- [å…ƒæ•°æ®æŸ¥è¯¢](#å…ƒæ•°æ®æŸ¥è¯¢)
- [é…ç½®](#é…ç½®)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [è´¡çŒ®](#è´¡çŒ®)
- [è®¸å¯è¯](#è®¸å¯è¯)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Python 3.12+
- [Conda](https://docs.conda.io/en/latest/miniconda.html) æˆ– Python ç¯å¢ƒç®¡ç†å·¥å…·
- [UnRAR](https://www.rarlab.com/rar_add.htm) å·¥å…·ï¼ˆå¤„ç†RAR/CBRæ–‡ä»¶å¿…éœ€ï¼‰

### Windows å¿«é€Ÿå®‰è£…

1. **å…‹éš†ä»“åº“**
```bash
git clone https://github.com/yourusername/manga-organizer.git
cd manga-organizer
```

2. **è¿è¡Œç¯å¢ƒé…ç½®è„šæœ¬**
```bash
scripts\setup_environment.bat
```

3. **æµ‹è¯•ç¯å¢ƒ**
```bash
scripts\run_test.bat
```

4. **å¼€å§‹æ•´ç†**
```bash
scripts\run_organizer.bat
```

## ğŸ“¦ å®‰è£…

### æ–¹æ³•1ï¼šä½¿ç”¨Condaï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
conda create -n manga python=3.12 -y

# æ¿€æ´»ç¯å¢ƒ
conda activate manga

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### æ–¹æ³•2ï¼šä½¿ç”¨pip

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»ç¯å¢ƒ
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### å®‰è£…UnRARï¼ˆå¿…éœ€ï¼‰

#### Windows
1. ä¸‹è½½ï¼šhttps://www.rarlab.com/rar_add.htm
2. è§£å‹åˆ°å›ºå®šä½ç½®ï¼ˆå¦‚ `C:\Program Files\UnRAR\`ï¼‰
3. è„šæœ¬å·²é…ç½®è·¯å¾„ä¸º `C:\Program Files\UnRAR\UnRAR.exe`

#### Linux
```bash
sudo apt-get install unrar
```

#### macOS
```bash
brew install unrar
```

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

1. **å°†å·¥å…·æ”¾åœ¨æ¼«ç”»æ”¶è—æ ¹ç›®å½•**

2. **è¿è¡Œä¸»è„šæœ¬**
```bash
python src/manga_organizer.py
```

3. **é€‰æ‹©æ¨¡å¼**
   - `y` - å¼€å§‹æ•´ç†ï¼ˆå®é™…æ‰§è¡Œï¼‰
   - `d` - é¢„æ¼”æ¨¡å¼ï¼ˆä»…æ˜¾ç¤ºæ•ˆæœï¼Œä¸ä¿®æ”¹æ–‡ä»¶ï¼‰
   - `n` - å–æ¶ˆ

### å‘½ä»¤è¡Œç”¨æ³•

```bash
# ç¯å¢ƒæµ‹è¯•
python src/test_environment.py

# å…ƒæ•°æ®æŸ¥è¯¢æµ‹è¯•
python src/metadata_fetcher.py

# ä¸»ç¨‹åºï¼ˆäº¤äº’æ¨¡å¼ï¼‰
python src/manga_organizer.py
```

### ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆWindowsï¼‰

```bash
# ç¯å¢ƒé…ç½®
scripts\setup_environment.bat

# ç¯å¢ƒæµ‹è¯•
scripts\run_test.bat

# è¿è¡Œæ•´ç†
scripts\run_organizer.bat
```

## ğŸ“¦ Komgaå‡†å¤‡å·¥å…·

### æ¦‚è¿°

Komgaå‡†å¤‡å·¥å…·ä¸“ä¸ºæ‹¥æœ‰**è¿œç¨‹KomgaæœåŠ¡å™¨**çš„ç”¨æˆ·è®¾è®¡ã€‚å®ƒåœ¨æœ¬åœ°å®Œæˆæ‰€æœ‰å…ƒæ•°æ®è·å–å’Œç›®å½•æ•´ç†å·¥ä½œï¼Œè¾“å‡ºä¸€ä¸ª**Komgaå°±ç»ªçš„ç›®å½•**ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚

#### é€‚ç”¨åœºæ™¯

- âœ… ä½ æœ‰ä¸€ä¸ªè¿œç¨‹KomgaæœåŠ¡å™¨ï¼ˆNASã€VPSç­‰ï¼‰
- âœ… æœ¬åœ°æœºå™¨ç½‘ç»œæ¡ä»¶æ›´å¥½ï¼Œé€‚åˆæŸ¥è¯¢å…ƒæ•°æ®
- âœ… å¸Œæœ›æœ¬åœ°å‡†å¤‡å¥½ä¸€åˆ‡ï¼Œå†æ•´ä½“ä¼ è¾“åˆ°æœåŠ¡å™¨
- âœ… éœ€è¦ComicInfo.xmlå…ƒæ•°æ®åµŒå…¥æ¯ä¸ªCBZæ–‡ä»¶

#### å·¥ä½œæµç¨‹

```
æœ¬åœ°å‡†å¤‡ â†’ æ•´ä½“ä¼ è¾“ â†’ Komgaè‡ªåŠ¨è¯†åˆ«
```

1. **æœ¬åœ°å‡†å¤‡é˜¶æ®µ**ï¼ˆæœ¬å·¥å…·ï¼‰
   - æ‰«æç°æœ‰æ¼«ç”»æ”¶è—
   - ä»å¤šä¸ªAPIæºè·å–å…ƒæ•°æ®ï¼ˆä¸­æ–‡ä¼˜å…ˆï¼‰
   - ç”ŸæˆComicInfo.xmlå¹¶åµŒå…¥CBZæ–‡ä»¶
   - ä¸‹è½½ç³»åˆ—å°é¢
   - æ•´ç†ä¸ºKomgaæ ‡å‡†ç›®å½•ç»“æ„

2. **ä¼ è¾“é˜¶æ®µ**ï¼ˆç”¨æˆ·æ“ä½œï¼‰
   - ä½¿ç”¨rsync/robocopy/scpç­‰å·¥å…·
   - å°†æ•´ä¸ªè¾“å‡ºç›®å½•å¤åˆ¶åˆ°KomgaæœåŠ¡å™¨

3. **Komgaè¯†åˆ«é˜¶æ®µ**ï¼ˆè‡ªåŠ¨ï¼‰
   - Komgaè¯»å–ComicInfo.xml
   - è‡ªåŠ¨æ˜¾ç¤ºä¸­æ–‡æ ‡é¢˜ã€ä½œè€…ã€ç®€ä»‹ç­‰
   - æ— éœ€åœ¨æœåŠ¡å™¨ä¸Šé…ç½®å…ƒæ•°æ®æ’ä»¶

### å…ƒæ•°æ®æº

å·¥å…·æ”¯æŒå¤šä¸ªAPIæºï¼ŒæŒ‰ä¼˜å…ˆçº§è‡ªåŠ¨èšåˆå…ƒæ•°æ®ï¼š

| æ•°æ®æº | ç±»å‹ | è¯­è¨€ | éœ€è¦API Key | ä¼˜å…ˆçº§ |
|--------|------|------|-------------|--------|
| **Bangumi** | æ—¥æ¼«/åŠ¨ç”» | ä¸­æ–‡åŸç”Ÿ | âŒ å¦ | 1 |
| **trace.moe** | AniListä»£ç† | ä¸­æ–‡ç¿»è¯‘ | âŒ å¦ | 2 |
| **AniList** | æ—¥æ¼«/è½»å°è¯´ | æ—¥/è‹± | âŒ å¦ | 3 |
| **ComicVine** | ç¾æ¼« | è‹±æ–‡ | âš ï¸ éœ€è¦ï¼ˆå…è´¹ï¼‰ | 4 |

#### è¯­è¨€ä¼˜å…ˆçº§

å·¥å…·ä¼šæŒ‰ä»¥ä¸‹é¡ºåºé€‰æ‹©æ ‡é¢˜å’Œç®€ä»‹ï¼š

```
ä¸­æ–‡ > æ—¥æ–‡ > ç½—é©¬éŸ³ > è‹±æ–‡
```

ä¾‹å¦‚ï¼š
- Bangumiæä¾›ä¸­æ–‡æ ‡é¢˜ï¼š"çŒç¯®é«˜æ‰‹"
- AniListæä¾›æ—¥æ–‡æ ‡é¢˜ï¼š"ã‚¹ãƒ©ãƒ ãƒ€ãƒ³ã‚¯"
- æœ€ç»ˆé€‰ç”¨ï¼š"çŒç¯®é«˜æ‰‹"ï¼ˆä¸­æ–‡ä¼˜å…ˆï¼‰

### é…ç½®

ç¼–è¾‘ `config.json` ä¸­çš„ `komga_prepare` éƒ¨åˆ†ï¼š

```json
{
  "komga_prepare": {
    "source_dirs": [
      "Z:/æ¼«ç”»/æ—¥æ¼«",
      "Z:/æ¼«ç”»/ç¾æ¼«",
      "Z:/æ¼«ç”»/æ¸¯æ¼«"
    ],
    "output_dir": "Z:/æ¼«ç”»-Komgaå°±ç»ª",

    "language_priority": ["zh", "ja", "romaji", "en"],

    "metadata_sources": {
      "bangumi": {
        "enabled": true,
        "priority": 1
      },
      "trace_moe": {
        "enabled": true,
        "priority": 2
      },
      "anilist": {
        "enabled": true,
        "priority": 3
      },
      "comicvine": {
        "enabled": false,
        "api_key": "",
        "priority": 4
      }
    },

    "cover_download": true,
    "create_series_comicinfo": false
  }
}
```

#### é…ç½®è¯´æ˜

- `source_dirs`: è¦å¤„ç†çš„æºç›®å½•åˆ—è¡¨
- `output_dir`: è¾“å‡ºç›®å½•ï¼ˆKomgaå°±ç»ªç›®å½•ï¼‰
- `language_priority`: è¯­è¨€ä¼˜å…ˆçº§ï¼ˆzh=ä¸­æ–‡, ja=æ—¥æ–‡, romaji=ç½—é©¬éŸ³, en=è‹±æ–‡ï¼‰
- `metadata_sources`: å¯ç”¨çš„å…ƒæ•°æ®æº
- `cover_download`: æ˜¯å¦ä¸‹è½½å°é¢
- `create_series_comicinfo`: æ˜¯å¦åˆ›å»ºç³»åˆ—çº§ComicInfo.xmlï¼ˆé€šå¸¸ä¸éœ€è¦ï¼‰

#### ComicVine API Keyï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ç¾æ¼«å…ƒæ•°æ®ï¼š

1. æ³¨å†Œè´¦å·ï¼šhttps://comicvine.gamespot.com/
2. è·å–API Keyï¼šhttps://comicvine.gamespot.com/api/
3. å¡«å…¥é…ç½®æ–‡ä»¶çš„ `api_key` å­—æ®µ
4. è®¾ç½® `enabled: true`

### ä½¿ç”¨æ–¹æ³•

#### 1. æ¿€æ´»ç¯å¢ƒ

```bash
conda activate manga
```

#### 2. è¿è¡Œå‡†å¤‡å·¥å…·

```bash
python src/komga_prepare.py
```

æˆ–ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼š

```bash
python src/komga_prepare.py --config my_config.json
```

#### 3. æŸ¥çœ‹è¿›åº¦

å·¥å…·ä¼šæ˜¾ç¤ºå®æ—¶è¿›åº¦ï¼š

```
==================================================
Komgaå‡†å¤‡å·¥å…·
==================================================
æ‰«æç›®å½•: Z:\æ¼«ç”»\æ—¥æ¼«

æ‰¾åˆ° 156 ä¸ªç³»åˆ—ï¼Œå…± 2341 å·

[1/156] å¤„ç†: çŒç¯®é«˜æ‰‹
  âœ“ è·å–å…ƒæ•°æ®: çŒç¯®é«˜æ‰‹
    å¤åˆ¶: çŒç¯®é«˜æ‰‹ v01.cbz
    å¤åˆ¶: çŒç¯®é«˜æ‰‹ v02.cbz
    ...

[2/156] å¤„ç†: æµ·è´¼ç‹
  âœ“ è·å–å…ƒæ•°æ®: ONE PIECE èˆªæµ·ç‹
    ...
```

#### 4. æ£€æŸ¥è¾“å‡º

è¾“å‡ºç›®å½•ç»“æ„ï¼š

```
Z:/æ¼«ç”»-Komgaå°±ç»ª/
â”œâ”€â”€ æ—¥æ¼«-ä¸­æ–‡ç‰ˆ/
â”‚   â”œâ”€â”€ äº•ä¸Šé›„å½¦/
â”‚   â”‚   â””â”€â”€ çŒç¯®é«˜æ‰‹/
â”‚   â”‚       â”œâ”€â”€ cover.jpg              # ç³»åˆ—å°é¢
â”‚   â”‚       â”œâ”€â”€ çŒç¯®é«˜æ‰‹ v01.cbz        # å†…å«ComicInfo.xml
â”‚   â”‚       â”œâ”€â”€ çŒç¯®é«˜æ‰‹ v02.cbz
â”‚   â”‚       â””â”€â”€ ...
â”‚   â””â”€â”€ å°¾ç”°è£ä¸€éƒ/
â”‚       â””â”€â”€ ONE PIECE èˆªæµ·ç‹/
â”‚           â”œâ”€â”€ cover.jpg
â”‚           â”œâ”€â”€ ONE PIECE èˆªæµ·ç‹ v01.cbz
â”‚           â””â”€â”€ ...
â”œâ”€â”€ æ—¥æ¼«-æ—¥æ–‡ç‰ˆ/
â”œâ”€â”€ ç¾æ¼«/
â”œâ”€â”€ æ¸¯æ¼«/
â””â”€â”€ TRANSFER_MANIFEST.txt          # ä¼ è¾“æ¸…å•
```

æ¯ä¸ªCBZæ–‡ä»¶å†…éƒ¨ç»“æ„ï¼š

```
çŒç¯®é«˜æ‰‹ v01.cbz
â”œâ”€â”€ ComicInfo.xml                  # å…ƒæ•°æ®æ–‡ä»¶
â”œâ”€â”€ 001.jpg                        # æ¼«ç”»é¡µé¢
â”œâ”€â”€ 002.jpg
â””â”€â”€ ...
```

#### 5. æ£€æŸ¥ComicInfo.xml

å¯ä»¥è§£å‹ä»»ä¸€CBZæ–‡ä»¶æŸ¥çœ‹ï¼š

```bash
unzip -p "çŒç¯®é«˜æ‰‹ v01.cbz" ComicInfo.xml
```

ç¤ºä¾‹è¾“å‡ºï¼š

```xml
<?xml version="1.0" ?>
<ComicInfo xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Series>çŒç¯®é«˜æ‰‹</Series>
  <Number>1</Number>
  <Count>31</Count>
  <Writer>äº•ä¸Šé›„å½¦</Writer>
  <Publisher>é›†è‹±ç¤¾</Publisher>
  <Year>1990</Year>
  <Summary>æè¿°é«˜ä¸­ç¯®çƒé˜Ÿçš„çƒ­è¡€é’æ˜¥æ•…äº‹...</Summary>
  <Genre>è¿åŠ¨, é’æ˜¥, åŠ±å¿—</Genre>
  <Manga>Yes</Manga>
  <LanguageISO>zh</LanguageISO>
  <Notes>Metadata from Bangumi (ID: 959)</Notes>
</ComicInfo>
```

### ä¼ è¾“åˆ°KomgaæœåŠ¡å™¨

å‡†å¤‡å®Œæˆåï¼Œä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¼ è¾“åˆ°KomgaæœåŠ¡å™¨ï¼š

#### æ–¹æ³•1: rsyncï¼ˆæ¨èï¼Œæ”¯æŒå¢é‡ï¼‰

```bash
# Windows â†’ LinuxæœåŠ¡å™¨
rsync -avz --progress "Z:/æ¼«ç”»-Komgaå°±ç»ª/" user@server:/data/komga/comics/
```

#### æ–¹æ³•2: robocopyï¼ˆWindowsåŸç”Ÿï¼‰

```bash
robocopy "Z:\æ¼«ç”»-Komgaå°±ç»ª" "\\server\komga\comics" /E /MT:8
```

#### æ–¹æ³•3: ç›´æ¥å¤åˆ¶åˆ°NAS

```bash
# æ˜ å°„ç½‘ç»œé©±åŠ¨å™¨å
xcopy "Z:\æ¼«ç”»-Komgaå°±ç»ª\*" "\\NAS\comics\" /E /H /C /I
```

#### æ–¹æ³•4: scpï¼ˆå•æ¬¡ä¼ è¾“ï¼‰

```bash
scp -r "Z:/æ¼«ç”»-Komgaå°±ç»ª" user@server:/data/komga/comics/
```

### ä¼ è¾“åæ“ä½œ

1. **è§¦å‘Komgaæ‰«æ**
   - ç™»å½•Komga Webç•Œé¢
   - è¿›å…¥åº“è®¾ç½®
   - ç‚¹å‡»"æ‰«æåº“æ–‡ä»¶"

2. **éªŒè¯å…ƒæ•°æ®**
   - æ£€æŸ¥ç³»åˆ—æ ‡é¢˜æ˜¯å¦æ˜¾ç¤ºä¸ºä¸­æ–‡
   - æ£€æŸ¥ä½œè€…ã€ç®€ä»‹æ˜¯å¦æ­£ç¡®
   - æ£€æŸ¥å°é¢æ˜¯å¦æ˜¾ç¤º

3. **é—®é¢˜æ’æŸ¥**
   - å¦‚æœå…ƒæ•°æ®æœªæ˜¾ç¤ºï¼Œæ£€æŸ¥Komgaè®¾ç½®ä¸­"å¯¼å…¥ComicInfo"æ˜¯å¦å¯ç”¨
   - å¦‚æœå°é¢æœªæ˜¾ç¤ºï¼Œæ£€æŸ¥æ–‡ä»¶æƒé™
   - æŸ¥çœ‹Komgaæ—¥å¿—ï¼š`/config/logs/`

### ComicInfo.xmlæ ‡å‡†

å·¥å…·ç”Ÿæˆçš„ComicInfo.xmlç¬¦åˆ **Anansi Project v2.0** æ ‡å‡†ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `Series` | ç³»åˆ—å | çŒç¯®é«˜æ‰‹ |
| `Number` | å·/æœŸå· | 1 |
| `Count` | æ€»å·/æœŸæ•° | 31 |
| `Writer` | ä½œè€… | äº•ä¸Šé›„å½¦ |
| `Penciller` | ç”»å¸ˆ | äº•ä¸Šé›„å½¦ |
| `Translator` | ç¿»è¯‘è€… | ï¼ˆå¦‚æœ‰ï¼‰ |
| `Publisher` | å‡ºç‰ˆç¤¾ | é›†è‹±ç¤¾ |
| `Year` | å‡ºç‰ˆå¹´ä»½ | 1990 |
| `Month` | å‡ºç‰ˆæœˆä»½ | 12 |
| `Summary` | ç®€ä»‹ | æè¿°å†…å®¹ |
| `Genre` | ç±»å‹æ ‡ç­¾ | è¿åŠ¨, é’æ˜¥ |
| `Manga` | æ˜¯å¦ä¸ºæ¼«ç”» | Yes |
| `LanguageISO` | è¯­è¨€ä»£ç  | zh, ja, en |
| `CommunityRating` | è¯„åˆ† | 4.5 (0-5åˆ†) |
| `Tags` | é¢å¤–æ ‡ç­¾ | çƒ­è¡€, ç»å…¸ |
| `Notes` | å¤‡æ³¨ | Metadata from Bangumi |

### ç»Ÿè®¡æŠ¥å‘Š

å®Œæˆåä¼šç”Ÿæˆå¤„ç†ç»Ÿè®¡ï¼š

```
==================================================
å¤„ç†ç»Ÿè®¡
==================================================
ç³»åˆ—æ€»æ•°: 156
å·²å¤„ç†ç³»åˆ—: 154
å·æ€»æ•°: 2341
å·²å¤„ç†å·: 2320
å…ƒæ•°æ®æ‰¾åˆ°: 148
å…ƒæ•°æ®æœªæ‰¾åˆ°: 6
é”™è¯¯: 2
==================================================
```

### æ—¥å¿—æ–‡ä»¶

- `komga_prepare.log` - è¯¦ç»†æ‰§è¡Œæ—¥å¿—
- `TRANSFER_MANIFEST.txt` - ä¼ è¾“å‘½ä»¤æ¸…å•ï¼ˆåœ¨è¾“å‡ºç›®å½•ï¼‰

### æ€§èƒ½å»ºè®®

- **é¦–æ¬¡è¿è¡Œ**: å»ºè®®å…ˆæµ‹è¯•å°æ‰¹é‡ï¼ˆ10-20ä¸ªç³»åˆ—ï¼‰
- **ç½‘ç»œ**: APIæŸ¥è¯¢éœ€è¦ç¨³å®šç½‘ç»œè¿æ¥
- **é€Ÿåº¦**: çº¦æ¯ç§’å¤„ç†1-2ä¸ªç³»åˆ—ï¼ˆå–å†³äºç½‘ç»œé€Ÿåº¦ï¼‰
- **å¹¶å‘**: ç›®å‰ä¸ºä¸²è¡Œå¤„ç†ï¼Œæœªæ¥ç‰ˆæœ¬å°†æ”¯æŒå¹¶å‘

### æ•…éšœæ’æŸ¥

#### é—®é¢˜: å…ƒæ•°æ®æœªæ‰¾åˆ°

**å¯èƒ½åŸå› :**
- ç³»åˆ—åä¸APIæ•°æ®åº“ä¸åŒ¹é…
- ç½‘ç»œè¿æ¥é—®é¢˜
- APIæºæœªå¯ç”¨

**è§£å†³æ–¹æ³•:**
1. æŸ¥çœ‹æ—¥å¿—äº†è§£å…·ä½“APIå“åº”
2. å°è¯•æ‰‹åŠ¨æœç´¢ç¡®è®¤æ˜¯å¦å­˜åœ¨
3. è°ƒæ•´ç³»åˆ—åç§°ï¼ˆé‡å‘½åçˆ¶ç›®å½•ï¼‰
4. å¯ç”¨æ›´å¤šå…ƒæ•°æ®æº

#### é—®é¢˜: ComicInfo.xmlæœªç”Ÿæ•ˆ

**å¯èƒ½åŸå› :**
- Komgaæœªå¯ç”¨ComicInfoå¯¼å…¥
- CBZæ–‡ä»¶æŸå
- XMLæ ¼å¼é”™è¯¯

**è§£å†³æ–¹æ³•:**
1. æ£€æŸ¥Komgaè®¾ç½® â†’ å¯¼å…¥ â†’ "å¯¼å…¥ComicInfo.xmlå…ƒæ•°æ®"
2. è§£å‹CBZéªŒè¯XMLå­˜åœ¨
3. ä½¿ç”¨XMLéªŒè¯å·¥å…·æ£€æŸ¥æ ¼å¼

#### é—®é¢˜: ä¼ è¾“é€Ÿåº¦æ…¢

**è§£å†³æ–¹æ³•:**
1. ä½¿ç”¨ rsync å¢é‡ä¼ è¾“ï¼ˆåªä¼ æ–°æ–‡ä»¶ï¼‰
2. å¯ç”¨å¤šçº¿ç¨‹ä¼ è¾“ï¼ˆrobocopy `/MT:8`ï¼‰
3. è€ƒè™‘å…ˆä¼ è¾“å…ƒæ•°æ®è¾ƒå°çš„æ–‡ä»¶
4. ä½¿ç”¨å±€åŸŸç½‘ç›´è¿ï¼ˆé¿å…WiFiï¼‰

## ğŸ“‚ ç›®å½•ç»“æ„

### è¾“å…¥ç»“æ„ï¼ˆç¤ºä¾‹ï¼‰

```
ä½ çš„æ¼«ç”»æ–‡ä»¶å¤¹/
â”œâ”€â”€ æ—¥æ¼«/
â”‚   â”œâ”€â”€ mokuro/
â”‚   â”œâ”€â”€ å·²æ•´ç†2025/
â”‚   â””â”€â”€ æ¼«ç”»æ•´ç†-æ—¥æ¼«ä¸­æ–‡/
â”‚       â”œâ”€â”€ åäºº/
â”‚       â”‚   â”œâ”€â”€ äº•ä¸Šé›„å½¦/
â”‚       â”‚   â””â”€â”€ å°¾ç”°è£ä¸€éƒ/
â”‚       â””â”€â”€ éåäºº/
â”œâ”€â”€ ç¾æ¼«/
â”‚   â”œâ”€â”€ New52/
â”‚   â”œâ”€â”€ Marvel/
â”‚   â””â”€â”€ DC/
â”œâ”€â”€ æ¸¯æ¼«/
â””â”€â”€ è¿ç¯ç”»/
```

### è¾“å‡ºç»“æ„

```
æ¼«ç”»-å·²æ•´ç†/
â”œâ”€â”€ æ—¥æ¼«/
â”‚   â”œâ”€â”€ ä¸­æ–‡ç‰ˆ/
â”‚   â”‚   â””â”€â”€ [æ¼«ç”»å®¶]/
â”‚   â”‚       â””â”€â”€ [ä½œå“å]/
â”‚   â”‚           â”œâ”€â”€ ä½œå“å - 001.cbz
â”‚   â”‚           â”œâ”€â”€ ä½œå“å - 002.cbz
â”‚   â”‚           â””â”€â”€ ...
â”‚   â”œâ”€â”€ æ—¥æ–‡ç‰ˆ/
â”‚   â””â”€â”€ åŒè¯­ç‰ˆ/
â”œâ”€â”€ ç¾æ¼«/
â”‚   â”œâ”€â”€ æ¼«å¨/
â”‚   â”œâ”€â”€ DC/
â”‚   â””â”€â”€ å…¶ä»–/
â”œâ”€â”€ æ¸¯æ¼«/
â”‚   â””â”€â”€ [ç³»åˆ—å]/
â””â”€â”€ è¿ç¯ç”»/
    â””â”€â”€ [åˆ†ç±»]/
```

## ğŸ·ï¸ å‘½åè§„èŒƒ

### æ–‡ä»¶å‘½åæ ¼å¼

```
ä½œå“å - å·å·.cbz
```

**ç¤ºä¾‹ï¼š**
- `çŒç¯®é«˜æ‰‹ - 001.cbz`
- `Action Comics - 001.cbz`
- `ç¥å…µç„å¥‡ - 01.cbz`

### å·å·æ ¼å¼

- è‡ªåŠ¨è¡¥é›¶åˆ°3ä½ï¼ˆæ—¥æ¼«ã€æ¸¯æ¼«ï¼‰
- ä¿æŒåŸæ ¼å¼ï¼ˆç¾æ¼«é€šå¸¸å¸¦æœŸå·ï¼‰

### æ”¯æŒçš„æ–‡ä»¶æ ¼å¼

| æºæ ¼å¼ | ç›®æ ‡æ ¼å¼ | å¤„ç†æ–¹å¼ |
|--------|----------|---------|
| `.zip` | `.cbz` | é‡å‘½å |
| `.rar` | `.cbz` | çœŸå®è½¬æ¢ |
| `.cbr` | `.cbz` | çœŸå®è½¬æ¢ |
| `.cbz` | `.cbz` | ä¿æŒåŸæ · |
| `.pdf` | `.pdf` | ä¿æŒåŸæ · |

## ğŸŒ å…ƒæ•°æ®æŸ¥è¯¢

### æ”¯æŒçš„APIæº

å·¥å…·æ”¯æŒå¤šä¸ªå…ƒæ•°æ®æºï¼Œè‡ªåŠ¨èšåˆä¿¡æ¯ä»¥æä¾›æœ€å®Œæ•´çš„ä¸­æ–‡å…ƒæ•°æ®ã€‚

#### Bangumiï¼ˆç•ªç»„è®¡åˆ’ï¼‰
- âœ… å…è´¹ï¼Œæ— éœ€API key
- âœ… ä¸­æ–‡åŸç”Ÿæ•°æ®
- âœ… æ—¥æ¼«ã€åŠ¨ç”»ã€æ¸¸æˆç­‰
- ğŸ“¡ API: https://api.bgm.tv

```python
from src.metadata_sources import BangumiSource

bangumi = BangumiSource()
metadata = bangumi.search("çŒç¯®é«˜æ‰‹")
print(f"æ ‡é¢˜: {metadata.title_zh}")
print(f"ä½œè€…: {', '.join(metadata.authors)}")
```

#### trace.moeï¼ˆAniListä»£ç†ï¼‰
- âœ… å…è´¹ï¼Œæ— éœ€API key
- âœ… AniListæ•°æ® + ä¸­æ–‡ç¿»è¯‘
- âœ… æä¾›AniListä¸æ”¯æŒçš„ä¸­æ–‡æ ‡é¢˜
- ğŸ“¡ API: https://trace.moe/anilist/

```python
from src.metadata_sources import TraceMoeSource

trace_moe = TraceMoeSource()
metadata = trace_moe.search("SLAM DUNK")
print(f"ä¸­æ–‡æ ‡é¢˜: {metadata.title_zh}")  # çŒç¯®é«˜æ‰‹
```

#### AniListï¼ˆæ—¥æ¼«/è½»å°è¯´ï¼‰
- âœ… å…è´¹ï¼Œæ— éœ€API key
- âœ… 50ä¸‡+ æ¡ç›®
- âœ… æ—¥æ–‡ã€ç½—é©¬éŸ³ã€è‹±æ–‡æ”¯æŒ
- ğŸ“¡ API: https://graphql.anilist.co

```python
from src.metadata_sources import AniListSource

anilist = AniListSource()
metadata = anilist.search("ONE PIECE")
print(f"æ—¥æ–‡æ ‡é¢˜: {metadata.title_native}")
print(f"ç½—é©¬éŸ³: {metadata.title_romaji}")
```

#### ComicVineï¼ˆç¾æ¼«ï¼‰
- âš ï¸ éœ€è¦å…è´¹API key
- âš ï¸ é™åˆ¶ï¼š200è¯·æ±‚/å°æ—¶
- âœ… æ¼«å¨ã€DCç­‰ç¾æ¼«å®Œæ•´æ•°æ®
- ğŸ“¡ API: https://comicvine.gamespot.com/api

```python
from src.metadata_sources import ComicVineSource

config = {'api_key': 'YOUR_API_KEY'}
comicvine = ComicVineSource(config)
metadata = comicvine.search("Batman")
print(f"å‡ºç‰ˆç¤¾: {metadata.publisher}")
```

**è·å–ComicVine API keyï¼š** https://comicvine.gamespot.com/api/

### ä½¿ç”¨ç¤ºä¾‹

#### å•ä¸ªæºæŸ¥è¯¢

```bash
# æµ‹è¯•Bangumi
python -c "from src.metadata_sources import BangumiSource; print(BangumiSource().search('æµ·è´¼ç‹'))"

# æµ‹è¯•trace.moe
python -c "from src.metadata_sources import TraceMoeSource; print(TraceMoeSource().search('ç«å½±å¿è€…'))"
```

#### å¤šæºèšåˆæŸ¥è¯¢ï¼ˆKomgaå‡†å¤‡å·¥å…·ä½¿ç”¨ï¼‰

```python
from src.metadata_sources import BangumiSource, TraceMoeSource, AniListSource

# å¤šä¸ªæºæŸ¥è¯¢å¹¶åˆå¹¶
sources = [BangumiSource(), TraceMoeSource(), AniListSource()]

final_metadata = None
for source in sources:
    metadata = source.search("çŒç¯®é«˜æ‰‹")
    if metadata:
        if final_metadata is None:
            final_metadata = metadata
        else:
            final_metadata.merge(metadata)

# ç»“æœåŒ…å«æ‰€æœ‰æºçš„ä¿¡æ¯
print(final_metadata.get_best_title())  # ä¸­æ–‡ä¼˜å…ˆ
```

## âš™ï¸ é…ç½®

### config.json

```json
{
  "paths": {
    "target_directory": "æ¼«ç”»-å·²æ•´ç†",
    "temp_directory": ".temp_conversion"
  },
  "formats": {
    "target_format": "cbz"
  },
  "naming": {
    "format": "{series_name} - {volume}",
    "volume_padding": 3
  }
}
```

### è‡ªå®šä¹‰åˆ†ç±»å…³é”®è¯

ç¼–è¾‘ `src/manga_organizer.py`:

```python
CATEGORY_KEYWORDS = {
    'æ—¥æ¼«': ['æ—¥æ¼«', 'æ—¥æœ¬', 'japanese', 'manga', 'jp', 'ä½ çš„å…³é”®è¯'],
    'ç¾æ¼«': ['ç¾æ¼«', 'ç¾å›½', 'american', 'comics', 'marvel', 'dc'],
    # ...
}
```

## ğŸ“Š è¾“å‡ºæ–‡ä»¶

### æ—¥å¿—æ–‡ä»¶
- `manga_organizer.log` - è¯¦ç»†æ‰§è¡Œæ—¥å¿—

### æŠ¥å‘Šæ–‡ä»¶
- `manga_analysis.json` - æ‰«æåˆ†ææŠ¥å‘Š
- `manga_final_report.json` - æœ€ç»ˆå¤„ç†æŠ¥å‘Š

### æŠ¥å‘Šç»“æ„ç¤ºä¾‹

```json
{
  "timestamp": "2025-01-17T12:00:00",
  "stats": {
    "total_files": 60656,
    "processed": 12345,
    "converted": 5678,
    "errors": 10
  },
  "files": [...]
}
```

## â“ å¸¸è§é—®é¢˜

### Q: åŸæ–‡ä»¶ä¼šè¢«åˆ é™¤å—ï¼Ÿ
**A:** ä¸ä¼šã€‚è„šæœ¬åªå¤åˆ¶æ–‡ä»¶åˆ°æ–°ç›®å½•ï¼ŒåŸæ–‡ä»¶ä¿æŒä¸å˜ã€‚å¤„ç†å®ŒæˆååŸç›®å½•ä¼šè¢«é‡å‘½åä¸º `[å·²å¤„ç†]åŸç›®å½•å`ã€‚

### Q: å¤„ç†60000+æ–‡ä»¶éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ
**A:** å–å†³äºæ–‡ä»¶å¤§å°å’Œæ˜¯å¦éœ€è¦æ ¼å¼è½¬æ¢ï¼š
- çº¯é‡å‘½å/ç§»åŠ¨ï¼šçº¦1-2å°æ—¶
- åŒ…å«RARâ†’CBZè½¬æ¢ï¼šå¯èƒ½éœ€è¦æ•°å°æ—¶

### Q: å¯ä»¥ä¸­é€”åœæ­¢å—ï¼Ÿ
**A:** å¯ä»¥ã€‚æŒ‰ `Ctrl+C` åœæ­¢ï¼Œå·²å¤„ç†çš„æ–‡ä»¶ä¼šä¿ç•™ã€‚

### Q: å¦‚ä½•æ¢å¤åŸçŠ¶ï¼Ÿ
**A:** åˆ é™¤ `æ¼«ç”»-å·²æ•´ç†` ç›®å½•ï¼Œå°†æ ‡è®°ä¸º `[å·²å¤„ç†]` çš„ç›®å½•é‡å‘½åå›åŸåå³å¯ã€‚

### Q: RARæ–‡ä»¶æ— æ³•å¤„ç†
**A:**
1. ç¡®è®¤UnRARå·²å®‰è£…
2. æ£€æŸ¥è·¯å¾„é…ç½®æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯

### Q: æ–‡ä»¶åä¹±ç 
**A:** Windowsä¸‹å¯èƒ½éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
set PYTHONIOENCODING=utf-8
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [AniList](https://anilist.co/) - æä¾›æ—¥æ¼«å…ƒæ•°æ®API
- [ComicVine](https://comicvine.gamespot.com/) - æä¾›ç¾æ¼«å…ƒæ•°æ®API
- [rarfile](https://github.com/markokr/rarfile) - Python RARæ–‡ä»¶å¤„ç†åº“

## ğŸ“® è”ç³»æ–¹å¼

- Issues: [GitHub Issues](https://github.com/yourusername/manga-organizer/issues)
- Discussions: [GitHub Discussions](https://github.com/yourusername/manga-organizer/discussions)

## ğŸ—ºï¸ è·¯çº¿å›¾

### å·²å®Œæˆ âœ…

- [x] å¤šå…ƒæ•°æ®æºï¼ˆBangumiã€trace.moeã€AniListã€ComicVineï¼‰
- [x] ComicInfo.xmlè‡ªåŠ¨ç”Ÿæˆï¼ˆAnansi v2.0æ ‡å‡†ï¼‰
- [x] å°é¢ä¸‹è½½å’Œç®¡ç†
- [x] Komgaå‡†å¤‡å·¥å…·ï¼ˆæœ¬åœ°å…ƒæ•°æ®å¤„ç†ï¼‰
- [x] è¯­è¨€ä¼˜å…ˆçº§ç³»ç»Ÿï¼ˆä¸­æ–‡ä¼˜å…ˆï¼‰
- [x] å…ƒæ•°æ®èšåˆå’Œåˆå¹¶

### è§„åˆ’ä¸­ ğŸ“‹

- [ ] GUIå›¾å½¢ç•Œé¢
- [ ] Webç•Œé¢
- [ ] å¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†
- [ ] é‡å¤æ–‡ä»¶æ£€æµ‹
- [ ] å¢é‡æ›´æ–°æ”¯æŒ
- [ ] Dockeræ”¯æŒ
- [ ] æ‰¹é‡é‡å‘½åå·¥å…·
- [ ] è‡ªåŠ¨è¯†åˆ«ç³»åˆ—å…³è”
- [ ] å…ƒæ•°æ®ç¼“å­˜ç³»ç»Ÿ
- [ ] Komga APIç›´æ¥é›†æˆ

---

**æ³¨æ„ï¼š** æœ¬å·¥å…·ä»…ä¾›ä¸ªäººå­¦ä¹ å’Œæ•´ç†ä½¿ç”¨ã€‚è¯·å°Šé‡ç‰ˆæƒï¼Œæ”¯æŒæ­£ç‰ˆã€‚
